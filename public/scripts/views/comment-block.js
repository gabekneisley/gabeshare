define(["jquery","underscore","backbone","templates","expanding","models/comment","views/comment","collections/comments"],function(e,t,n,r,i,s,o,u){var a=n.View.extend({tagName:"section",className:"comment-component",events:{'click [data-insertion="user-comment"]':"postComment"},initialize:function(){this.$el.append(r.commentBlock.render({title:"Leave Feedback",prompt:"What do you think about this project?"})),this.$list=this.$(".comment-list"),this.$input=this.$(".comment-input"),this.$input.expandingTextarea(),this.commentViews=[],this.comments=new u,this.comments.on("fetch-complete",this.addAll,this),e("#comment_component_placeholder").replaceWith(this.$el)},addAll:function(){this.comments.each(this.add,this)},add:function(e){var t=new o({model:e});this.commentViews.unshift(t),this.$list.prepend(t.$el)},postComment:function(e){var t=this.$input.val();if(!t)return!1;var n=s.fromText(t);this.comments.add(n),this.add(n),this.$input.val("")}});return a});